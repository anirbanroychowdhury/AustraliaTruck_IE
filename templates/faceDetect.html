{% extends 'base.html' %}
{% load static %}
{%block stylesheets%}
    <!-- CSS here -->
    <link rel="stylesheet" href="{% static "/css/bootstrap.min.css" %}">
    <link rel="stylesheet" href="{% static "/css/owl.carousel.min.css" %}">
    <link rel="stylesheet" href="{% static "/css/slicknav.css" %}">
    <link rel="stylesheet" href="{% static "/css/flaticon.css" %}">
    <link rel="stylesheet" href="{% static "/css/animate.min.css" %}">
    <link rel="stylesheet" href="{% static "/css/magnific-popup.css" %}">
    <link rel="stylesheet" href="{% static "/css/fontawesome-all.min.css" %}">
    <link rel="stylesheet" href="{% static "/css/themify-icons.css" %}">
    <link rel="stylesheet" href="{% static "/css/slick.css" %}">
    <link rel="stylesheet" href="{% static "/css/nice-select.css" %}">
    <link rel="stylesheet" href="{% static "/css/style.css" %}">
{%endblock stylesheets%}
{% block content %}


    <main>

        <!-- Hero Start-->

        <div class="hero-area2  slider-height2 hero-overly2 d-flex align-items-center " data-background="{% static "/img/hero/h2_hero.jpg"%}">
            <div class="container">
                <div class="row">
                    <div class="col-xl-12">
                        <div class="hero-cap text-center pt-50">
                            <h2>Fatigue Detection</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
         <br><br>
            <div class="container box_1170" style="text-align:center;">
                         <div class="container box_1170">
                                             <p class="sample-text" >
                                                 Fatigue detection provides our user with a
                                                 feature that helps them stay awake. By the usage
                                                 of OpenCV framework, we are able to detect facial
                                                 feature that depicts if the user is feeling drowsy or not.
                                                 Based on users eye movement and yawning we can identify and
                                                 sound an alarm if they end up sleeping.
                                             </p>


<!--                         </div>-->
                         </div>
                <br><br>
                <h2 class="text-heading">Camera Video</h2>
                  <div class="invisible" >
                    <video id="video" style="visibility: visible;">Your browser does not support the video tag.</video>
                  </div>
                <br><br>
                <h2 class="text-heading">Processed Video Stream</h2>
                    <div class="image">
                        <img id="returned-image">
                    </div>
                <br><br>
                <a class="btn btn-primary" href="{% url 'stopvideosession' %}">Close session</a>
            <section class="sample-text-area">
           
        </section>
            </div>
        <br><br>
        <div class="container box_1170">
            <p class="sample-text" >
                By using the OpenCV framework and machine learning,
                we can detect user's eyes and the number of time they blink.
                Based on such factors we can create an early warning system to WAKE THEM UP!
            </p>
            <p class="sample-text" >
                To implement this we use EAR (eye aspect ratio) to measure eye blinks over a period of time.
                Based on our analysis, whenever the EAR value on the screen goes below 0.2 for more than 15sec,
                the system will assume that the user has fallen asleep at the wheel and will sound an alarm.
            </p>
            <p class="text-heading" style="font-size:12px">NOTE: This application requires camera/webcam access. It will not work if it
                is being used by another application (e.g. Zoom)</p>
            </div>

    <audio id="alarmSound" src="{% static 'alarm.wav' %}"></audio>
    </main>

{% endblock content %}

{% block scripts %}
<script src="{% static 'js/faceDetection.js' %}"></script>
<script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
<script src="https://threejs.org/examples/js/libs/stats.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.5/dat.gui.min.js"></script>
<script>
  var Module = {
     wasmBinaryFile: 'https://huningxin.github.io/opencv.js/build/wasm/opencv_js.wasm',
    preRun: [function() {
      Module.FS_createPreloadedFile('/', 'haarcascade_eye.xml', 'https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_eye.xml', true, false);
      Module.FS_createPreloadedFile('/', 'haarcascade_frontalface_default.xml', 'https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_default.xml', true, false);
      Module.FS_createPreloadedFile('/', 'haarcascade_profileface.xml', 'https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_profileface.xml', true, false);
    }],
    _main: function() {opencvIsReady();}
  };
</script>
<script async src="https://huningxin.github.io/opencv.js/build/wasm/opencv.js"></script>

{% endblock scripts %}